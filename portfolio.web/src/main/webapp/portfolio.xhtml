<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<title>Portfolio</title>
	
	
<f:metadata>
    <f:viewParam name="portfolioId" value="#{sharePortfolio.id}" />
   <f:viewAction action="#{portfolioController.init(sharePortfolio)}" />
    
</f:metadata>
	
	<h:outputStylesheet library="css" name="style.css"  />
</h:head>
<h:body>
<h1>Portfolio anlegen </h1>

<h:form>

<h:panelGrid columns="2" style="margin-bottom: 25px;">
	<p:outputLabel  for="name"  value="Name"   />
	
	<h:panelGrid columns="2">
	<p:inputText id="name" value="#{sharePortfolio.name}" required="true"  validatorMessage="5 bis 30 Zeichen [Buchstaben,Ziffern-_]" requiredMessage="Mußfeld"  >
	
	<f:validateRegex pattern="[a-z,A-Z,0-9-_]{5,30}"  />
	
	</p:inputText >
	<p:message for="name"  /> 
	
	
	</h:panelGrid>
	
	<p:outputLabel  for="variances"  value="σ [%]"  rendered="#{sharePortfolio.standardDeviations.size() > 0}" />
	
	<p:dataTable id="variances"  emptyMessage=""    var="portfolio" value="#{sharePortfolio.standardDeviations}"  styleClass="hide-column-names"  rendered="#{sharePortfolio.standardDeviations.size() > 0}" >
	 	<p:column>
            <h:outputText value="#{portfolio.key}" />
        </p:column>
        
        <p:column>
            <h:outputText value="#{100*portfolio.value}" >
             <f:convertNumber pattern="#0.00" />
            </h:outputText>
        </p:column>
	
	</p:dataTable>

	<p:outputLabel  for="weights"  value="Gewichte [%]"  rendered="#{sharePortfolio.weights.size() > 0}" />
	
	<p:dataTable id="weights"  emptyMessage=""    var="weights" value="#{sharePortfolio.weights}"  styleClass="hide-column-names"  rendered="#{sharePortfolio.weights.size() > 0}" >
		<p:column>
            <h:outputText value="#{weights.key}" />
        </p:column>
        <p:column>
            <h:outputText value="#{100*weights.value}" >
             <f:convertNumber pattern="#0.00" />
            </h:outputText>
        </p:column>
	</p:dataTable>
	
	
</h:panelGrid >

<ui:fragment rendered="#{sharePortfolio.minStandardDeviation != null || sharePortfolio.uniformlyDistributedStandardDeviation != null}">
	<table style="border-collapse: collapse; margin-bottom: 25px;" >
		<tr> <th colspan="2">Standardabweichungen Portfolio [‰] </th></tr>
		<tr>
			<td style="border: 1px solid black;">minimales Risiko</td> 
			<td style="border: 1px solid black;"> 
				<h:outputText value="#{1000*sharePortfolio.minStandardDeviation}" >
				 	<f:convertNumber pattern="#0.0000" />
				</h:outputText>
			</td> 
		</tr>
		<tr>
			<td style="border: 1px solid black;">gleichverteilt</td>
			<td style="border: 1px solid black;">
				<h:outputText value="#{1000*sharePortfolio.uniformlyDistributedStandardDeviation}">
					<f:convertNumber pattern="#0.0000" />
				</h:outputText>
			</td>
		</tr>
	</table>
</ui:fragment>

<ui:fragment rendered="#{sharePortfolio.correlations.size() > 0}">
<table style="border-collapse: collapse; width: 100%; margin-bottom: 25px;" >
	<tr  >
	<th style="border: 1px solid black;">Korrelationen [%]</th>
	<ui:repeat value="#{sharePortfolio.shares}" var="share">
		<td style="border: 1px solid black;">
	 
	   <h:outputText value="#{share}" />
	   </td>
	</ui:repeat>
	</tr>
	
	<ui:repeat value="#{sharePortfolio.correlations}" var="correlation">
		<tr>
		<td style="border: 1px solid black;">
	 
	   <h:outputText value="#{correlation.key}" />
	   </td >
	
	
	<ui:repeat value="#{sharePortfolio.shares}" var="share">
		<td style="border: 1px solid black;">
		 <h:outputText value="#{100*correlation.value[share]}" >
		  <f:convertNumber pattern="#0.00" />
		 </h:outputText>
		</td >
	</ui:repeat>

	</tr>
	</ui:repeat>
	
	</table>
</ui:fragment>

<h:panelGrid >
<p:messages id="messages" showDetail="false" globalOnly="true" />
<h:panelGrid columns="3" >
 	<p:button  value="abbrechen" outcome="portfolios"  />
 	<p:commandButton value="pdf"  ajax="false"  action="#{portfolioController.pdf(sharePortfolio,facesContext)}"  rendered="#{sharePortfolio.standardDeviations.size() >= 2 }" />
	<p:commandButton value="speichern"  process="@form" update="@form" action="#{portfolioController.save(sharePortfolio.sharePortfolio,facesContext,'Portfolio mit diesem Namen existiert bereits')}" />
</h:panelGrid >   
</h:panelGrid >
 
        
</h:form>

	
	


</h:body>

</html>